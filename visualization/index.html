<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>데이트 코스 추천 서비스</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Mochiy+Pop+P+One&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 28px;
            background: linear-gradient(135deg, #f8e1e9, #e8d7f1); /* 슬라이드의 핑크-퍼플 그라데이션 */
            color: #4a4a4a; /* 텍스트는 슬라이드처럼 어두운 회색 */
        }
        h2 {
            font-family: 'Mochiy Pop P One', sans-serif;
            font-size: 42px;
            color: #a64ac9; /* 슬라이드 제목의 퍼플 톤 */
            text-shadow: 1px 1px 3px rgba(166, 74, 201, 0.2);
        }
        label {
            font-size: 22px;
            margin-bottom: 14px;
            color: #4a4a4a;
        }
        select, button, textarea {
            margin: 14px 0;
            width: 420px;
            font-size: 20px;
            font-family: 'Noto Sans KR', sans-serif;
        }
        select {
            padding: 14px;
            border: 2px solid #d4c2e2; /* 슬라이드의 연한 퍼플 테두리 */
            border-radius: 8px;
            background-color: #f5e9f2; /* 연한 핑크 배경 */
            color: #4a4a4a;
        }
        button {
            padding: 14px;
            background-color: #a64ac9; /* 퍼플 버튼 */
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #8e3ab8; /* 더 진한 퍼플 호버 */
        }
        textarea {
            height: 280px;
            resize: none;
            border: 2px solid #d4c2e2;
            border-radius: 8px;
            background-color: #fff7f9; /* 아주 연한 핑크 */
            color: #4a4a4a;
            padding: 14px;
        }
    </style>
</head>
<body>
    <h2>데이트 코스 추천 서비스</h2>
    <label for="region-select">사랑하는 너와 갈 지역을 골라봐:</label>
    <select id="region-select">
        <option value="">-- 선택 --</option>
        <option value="강남 MICE 관광특구">강남 MICE 관광특구</option>
        <option value="경복궁">경복궁</option>
        <option value="홍대 관광특구">홍대 관광특구</option>
        <option value="몽마르뜨공원">몽마르뜨공원</option>
    </select>
    <button onclick="recommendPlaces()">추천 받기</button>
    <textarea id="result-text" readonly></textarea>

    <script>
        // 샘플 데이터 (spot 테이블)
        const spotData = [
            { datetime: new Date(2025, 2, 28, 7, 15), region: '강남 MICE 관광특구', station: '삼성역', gu: '강남구', min_population: 3000, max_population: 3500, temp: 5, precipitation: 0, rain_chance: 0, precpt_type: '없음', air_idx: '90.0', sky_stts: '구름많음', humidity: 51, wind_spd: 3.6, uv_idx: 90 },
            { datetime: new Date(2025, 2, 28, 7, 15), region: '경복궁', station: '경복궁역', gu: '종로구', min_population: 500, max_population: 600, temp: 4, precipitation: 0, rain_chance: 0, precpt_type: '없음', air_idx: '97.0', sky_stts: '구름많음', humidity: 59, wind_spd: 3.5, uv_idx: 97 },
            { datetime: new Date(2025, 2, 28, 7, 20), region: '홍대 관광특구', station: '합정역', gu: '마포구', min_population: 20000, max_population: 22000, temp: 5, precipitation: 0, rain_chance: 0, precpt_type: '없음', air_idx: '85.0', sky_stts: '구름많음', humidity: 52, wind_spd: 4.1, uv_idx: 85 },
            { datetime: new Date(2025, 2, 28, 7, 20), region: '몽마르뜨공원', station: '홍대입구역', gu: '마포구', min_population: 1000, max_population: 1500, temp: 5, precipitation: 0, rain_chance: 0, precpt_type: '없음', air_idx: '85.0', sky_stts: '구름많음', humidity: 52, wind_spd: 4.1, uv_idx: 85 }
        ];

        // 가상 놀거리 데이터
        const playData = [
            { region: '강남 MICE 관광특구', place: '강남 카페', category: 'indoor' },
            { region: '경복궁', place: '경복궁 박물관', category: 'indoor' },
            { region: '홍대 관광특구', place: '홍대 클럽', category: 'indoor' },
            { region: '몽마르뜨공원', place: '몽마르뜨 언덕', category: 'outdoor' }
        ];

        // DPI 계산 함수
        function calculateThi(temp, humidity) {
            return 0.81 * temp + 0.01 * humidity * (0.99 * temp - 14.3) + 46.3;
        }

        function estimateSunlight(skyStts) {
            if (skyStts === '맑음') return 8;
            else if (skyStts === '구름많음') return 4;
            else if (skyStts === '흐림') return 2;
            else return 0;
        }

        function calculateDpi(row) {
            const temp = row.temp;
            const precipitation = row.precipitation;
            const humidity = row.humidity;
            const airIdx = parseFloat(row.air_idx);
            const skyStts = row.sky_stts;

            const thi = calculateThi(temp, humidity);
            const sunlight = estimateSunlight(skyStts);

            let indoorDpi = 50;
            if (precipitation >= 5) indoorDpi += 20;
            if (thi > 80) indoorDpi += 20;
            if (airIdx > 100) indoorDpi += 20;
            if (temp < 5 || temp > 35) indoorDpi += 15;
            indoorDpi = Math.min(indoorDpi, 100);

            let outdoorDpi = 50;
            if (precipitation >= 5) outdoorDpi -= 20;
            if (thi > 80) outdoorDpi -= 20;
            if (airIdx > 100) outdoorDpi -= 20;
            if (sunlight > 6) outdoorDpi += 15;
            outdoorDpi = Math.min(Math.max(outdoorDpi, 0), 100);

            return [indoorDpi, outdoorDpi];
        }

        // 추천 함수
        function recommendPlaces() {
            const region = document.getElementById('region-select').value;
            const resultText = document.getElementById('result-text');
            resultText.value = '';

            const spotRow = spotData.find(row => row.region === region);
            if (spotRow) {
                const [indoorDpi, outdoorDpi] = calculateDpi(spotRow);

                resultText.value += `지역: ${region}\n`;
                resultText.value += `실내 DPI: ${indoorDpi}\n`;
                resultText.value += `실외 DPI: ${outdoorDpi}\n\n`;

                const recommendedPlaces = playData.filter(place => place.region === region);
                let place, category;
                if (indoorDpi > outdoorDpi) {
                    place = recommendedPlaces.find(p => p.category === 'indoor');
                    category = '실내';
                } else {
                    place = recommendedPlaces.find(p => p.category === 'outdoor');
                    category = '실외';
                }

                if (place) {
                    resultText.value += `추천: ${place.place} (${category})\n`;
                } else {
                    resultText.value += '추천 장소가 없습니다.\n';
                }
            } else {
                resultText.value = '해당 지역의 데이터가 없습니다.\n';
            }
        }
    </script>
</body>
</html>